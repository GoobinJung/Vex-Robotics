CODE



#include <stdio.h>
#include <stdlib.h>
#include <stdbool.h>
#include <math.h>
#include <string.h>


#include "vex.h"

using namespace vex;


brain Brain;


// START V5 MACROS
#define waitUntil(condition)                                                   \
  do {                                                                         \
    wait(5, msec);                                                             \
  } while (!(condition))

#define repeat(iterations)                                                     \
  for (int iterator = 0; iterator < iterations; iterator++)
// END V5 MACROS


// Robot configuration code.




void initializeRandomSeed(){
  int systemTime = Brain.Timer.systemHighResolution();
  double batteryCurrent = Brain.Battery.current();
  double batteryVoltage = Brain.Battery.voltage(voltageUnits::mV);


  int seed = int(batteryVoltage + batteryCurrent * 100) + systemTime;

  // Set the seed
  srand(seed);
}



void vexcodeInit() {


  initializeRandomSeed(); 
}



void playVexcodeSound(const char *soundName) {
  printf("VEXPlaySound:%s\n", soundName);
  wait(5, msec);
}

#pragma endregion VEXcode Generated Robot Configuration
#include "vex.h"
using namespace vex;


brain       Brain;
controller  Controller1;


motor LeftMotor (PORT1,  ratio18_1, false);
motor RightMotor(PORT10, ratio18_1, true);


motor ClawMotor (PORT6,  ratio18_1, false);


motor ArmMotor  (PORT7,  ratio36_1, false);   


int DRIVE_SCALE = 35;   
int CLAW_SCALE  = 20;  
int ARM_SCALE   = 25;   
constexpr int DEADBAND  = 5;

inline int applyDeadband(int v, int dead = DEADBAND) {
  return (v > dead || v < -dead) ? v : 0;
}
inline int clamp100(int v) {
  if (v > 100)  return 100;
  if (v < -100) return -100;
  return v;
}
inline int iabs(int v) { return (v < 0) ? -v : v; }

int main() {
  LeftMotor.setStopping(coast);
  RightMotor.setStopping(coast);
  ClawMotor.setStopping(hold);
  ArmMotor.setStopping(hold);

  while (true) {

    int fwd  = -applyDeadband(Controller1.Axis3.position());
    int turn =  applyDeadband(Controller1.Axis1.position());

    int leftCmd  = clamp100((fwd + turn) * DRIVE_SCALE / 100);
    int rightCmd = clamp100((fwd - turn) * DRIVE_SCALE / 100);

    LeftMotor.spin(forward,  leftCmd,  percent);
    RightMotor.spin(forward, rightCmd, percent);


    if (Controller1.ButtonL1.pressing()) {
      int clawIn = applyDeadband(Controller1.Axis2.position());
      if (clawIn != 0) {
        ClawMotor.spin((clawIn > 0) ? forward : reverse,
                       iabs(clawIn) * CLAW_SCALE / 100, percent);
      } else {
        ClawMotor.stop(hold);
      }
    } else {
      ClawMotor.stop(hold);
    }


    if (Controller1.ButtonL2.pressing()) {
      int armIn = applyDeadband(Controller1.Axis2.position());
      if (armIn != 0) {
        ArmMotor.spin((armIn > 0) ? forward : reverse,
                      iabs(armIn) * ARM_SCALE / 100, percent);
      } else {
        ArmMotor.stop(hold);
      }
    } else {
      ArmMotor.stop(hold);
    }


    if (Controller1.ButtonA.pressing()) DRIVE_SCALE = 40;
    if (Controller1.ButtonB.pressing()) DRIVE_SCALE = 70;

    wait(20, msec);
  }
}
